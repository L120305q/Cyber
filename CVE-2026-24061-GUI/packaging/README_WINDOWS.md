# Offline Windows build instructions

This folder contains helper files to build `cve_2026_24061_gui.exe` on a Windows machine without internet access.

Steps (recommended on a separate machine with internet):

1. On an online machine (Windows or Linux), create a wheelhouse with required packages:

```powershell
python -m pip download -d wheelhouse -r packaging/requirements-pkg.txt
```

2. Copy the following to the offline Windows machine:
- the repository root (including `cve_2026_24061_gui.py`)
- `packaging/requirements-pkg.txt`
- the downloaded `wheelhouse` folder (rename to `packaging\wheels` beside the scripts)

3. On the offline Windows machine, open a command prompt in `packaging` and run:

```bat
build_windows.bat
```

4. After the build completes, the output will be in `dist\cve_2026_24061_gui` (one-folder) or a single-file EXE if you change the script to `--onefile`.

Notes:
- Building a Windows PyQt5 application should be done on Windows for compatibility (Qt platform plugins and DLLs).
- If you need a portable single-file EXE, change `--onedir` to `--onefile` in the build script (may increase antivirus false positives).
- If you want to include an icon, add `--icon=youricon.ico` to the PyInstaller command.

---

## GitHub Actions: Windows build (CI) ✅

A workflow has been added at `.github/workflows/windows-build.yml` that will produce a single-file Windows EXE using a Windows runner. You can trigger it manually from the Actions tab ("Run workflow") or it will run on pushes to `main`/`master` and on pull requests.

- The build will install dependencies (from `packaging/requirements-pkg.txt`), run PyInstaller to create a `onefile` EXE, and upload the artifact named `cve_2026_24061_gui-windows-exe` containing `cve_2026_24061_gui.exe`.
- After the workflow completes, download the artifact from the Actions run — the resulting EXE is self-contained and can be executed on Windows without further downloads.

Notes:
- If you require signed binaries, a private signing step should be added to the workflow.
- If you prefer a reproducible offline artifact, you can still generate a wheelhouse locally and use the `packaging` scripts on an offline Windows machine.
